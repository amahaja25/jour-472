---
title: "Reverse Engineering Project Notebook"
output: html_notebook
---

Load libraries.

```{r}
options(scipen=999)

library(tidyverse)
library(readr)
library(janitor)
library(lubridate)
```

Load data. Change amount column from character to a number.

```{r}

#change Amount from <chr> to <dbl> by getting rid of special characters

sportsdonation <- read_csv("data/sports-political-donations.csv") |>
  clean_names() |>
  mutate(amount = str_replace_all(amount,'\\$','')) |>
  mutate(amount = str_replace_all(amount, '\\,','')) |>
  mutate(amount = as.numeric(amount))
  
sportsdonation
```

"American professional sports owners have contributed **nearly \$47 million in federal elections** since 2015, according to research by ESPN in partnership with FiveThirtyEight, including **\$10 million to Republican causes** and **\$1.9 million to Democratic causes** so far in the 2020 election cycle."

```{r}

#sum total donations: $46,978,697 ~ nearly $47 million.

sportsdonation |>
  summarise(amount) |>
  sum()

#find total Democrat donations specific to 2020 election cycle: $1,877,133 ~ $1.9 million.

sportsdonation |>
  filter(str_detect(party, "Democrat")) |>
  filter(election_year== "2020") |>
  summarise(amount) |>
  sum()

#find total Republican donations specific to 2020 election cycle: $10,111,284 ~ $10 million.

sportsdonation |>
  filter(str_detect(party, "Republican")) |>
  filter(election_year == "2020") |>
  summarise(amount) |>
  sum()

```

"The research includes more than **160 owners** and commissioners spanning **125 teams**"

```{r}

#number of owners —— 158 rows, have to figure out way to get both owners and commisioners for the "more than 160 owners and commisioners"
sportsdonation |>
  group_by(owner) |>
  summarise(n())


sportsdonation |>
  summarise(unique(team))

#some of the owners own multiple teams, need to figure out later
```

**Which team owners gave the most?**

Donations from team owners, by cyle and party donated to: (this was in a table in the original story)

Who provided the highest number of donations? **Charles Johnson.**

```{r}

sportsdonation |>
  group_by(owner) |>
  summarise(total_donations = n()) |>
  arrange(desc(total_donations))

```

Which league gave the most individual donations? **MLB**

```{r}

sportsdonation |>
  group_by(league) |>
  summarise(total_donation = n()) |>
  arrange(desc(total_donation))


```

How many donations for each party?

```{r}

sportsdonation |> 
  group_by(Party) |>
  summarise(n()) 

```

Overall, **51.7 percent of all contributions by WNBA owners went to Democrats**, with **42.3 percent going to Republicans.** And of the **\$1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler,** the Republican from Georgia who is co-owner of the Atlanta Dream.

```{r}
sportsdonation |>
  filter(league == 'WNBA') |>
  group_by(owner) |>
  summarise(wnba_amt = sum(amount)) |>
  arrange(desc(wnba_amt))

#Kelly Loeffler: $896,150

sportsdonation |>
  filter(league == 'WNBA') |>
  group_by(party) |>
  summarise(sum(amount))

#when adding up Republican WNBA spending, the total is $1,059,302 — this is not $1.3m, have to figure out what went wrong
# 973459+82093+3750 = 1059302
```

"There are 40 owners who have donated at least \$100,000 to Republican causes over the six-year period, compared to 23 owners topping \$100,000 to Democrats, helping lead to these splits."

```{r}

# Which year had the most donations?

sportsdonation |>
  group_by(election_year) |>
  summarise(count_per_year = n()) |>
  arrange(desc(count_per_year))

sportsdonation |>
  group_by(owner) 
  


```

\"A deep search in the Federal Election Commission database of campaign finances for principal owners, controlling owners, co-owners and commissioners from the NBA, NFL, NHL, WNBA, MLB and NASCAR reveals that this deep-pocketed group has sent **\$34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican** causes, compared to \$10.1 million (21.5 percent) to Democrats over the past three elections. Less than 6 percent of contributions went to bipartisan or unaffiliated recipients.\"

```{r}

sportsdonation |>
  filter(L)

```
