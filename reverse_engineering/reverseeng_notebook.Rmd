---
title: "Reverse Engineering Project Notebook"
output: html_notebook
---

Load libraries.

```{r}
options(scipen=999)

library(tidyverse)
library(readr)
library(janitor)
library(lubridate)
```

Load data. Change amount column from character to a number.

```{r}

#change Amount from <chr> to <dbl> by getting rid of special characters

sportsdonation <- read_csv("data/sports-political-donations.csv") |>
  mutate(Amount = str_replace_all(Amount,'\\$','')) |>
  mutate(Amount = str_replace_all(Amount, '\\,','')) |>
  mutate(Amount = as.numeric(Amount))
  

```

"American professional sports owners have contributed **nearly \$47 million in federal elections** since 2015, according to research by ESPN in partnership with FiveThirtyEight, including **\$10 million to Republican causes** and **\$1.9 million to Democratic causes** so far in the 2020 election cycle."

```{r}

#sum total donations: $46,978,697 ~ nearly $47 million.

sportsdonation |>
  summarise(Amount) |>
  sum()

#find total Democrat donations specific to 2020 election cycle: $1,877,133 ~ $1.9 million.

sportsdonation |>
  filter(str_detect(Party, "Democrat")) |>
  filter(`Election Year`== "2020") |>
  summarise(Amount) |>
  sum()

#find total Republican donations specific to 2020 election cycle: $10,111,284 ~ $10 million.

sportsdonation |>
  filter(str_detect(Party, "Republican")) |>
  filter(`Election Year` == "2020") |>
  summarise(Amount) |>
  sum()

```

"The research includes more than **160 owners** and commissioners spanning **125 teams**"

```{r}

#number of owners —— 158 rows, have to figure out way to get both owners and commisioners for the "more than 160 owners and commisioners"
sportsdonation |>
  group_by(Owner) |>
  summarise(n())


sportsdonation |>
  summarise(unique(Team))

#some of the owners own multiple teams, need to figure out later
```

**Which team owners gave the most?**

Donations from team owners, by cyle and party donated to:

Who provided the highest number of donations? **Charles Johnson.**

```{r}

sportsdonation |>
  group_by(Owner) |>
  summarise(total_donations = n()) |>
  arrange(desc(total_donations))

```

Which league gave the most individual donations? **MLB**

```{r}

sportsdonation |>
  group_by(League) |>
  summarise(total_donation = n()) |>
  arrange(desc(total_donation))


```

How many donations for each party?

```{r}

sportsdonation |> 
  group_by(Party) |>
  summarise(n()) 

```

Overall, **51.7 percent of all contributions by WNBA owners went to Democrats**, with **42.3 percent going to Republicans.** And of the **\$1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler,** the Republican from Georgia who is co-owner of the Atlanta Dream.

```{r}
sportsdonation |>
  filter(League == 'WNBA') |>
  group_by(Owner) |>
  summarise(wnba_amt = sum(Amount)) |>
  arrange(desc(wnba_amt))

#Kelly Loeffler: $896,150

sportsdonation |>
  filter(League == 'WNBA') |>
  group_by(Party) |>
  summarise(sum(Amount))

#when adding up Republican WNBA spending, the total is $1,059,302 — this is not $1.3m, have to figure out what went wrong
973459+82093+3750 
```

"There are 40 owners who have donated at least \$100,000 to Republican causes over the six-year period, compared to 23 owners topping \$100,000 to Democrats, helping lead to these splits."

Which year had the most donations?

```{r}

sportsdonation |>
  group_by(`Election Year`) |>
  summarise(count_per_year = n()) |>
  arrange(desc(count_per_year))



```
